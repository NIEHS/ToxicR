doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
parms <- c(0.0657267,
2.7553,
0.48128 *486.690430,
1/100,
0.449643*9486.690430,
1/100)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
parms <- c(0.0657267,
2.7553,
0.48128 *486.690430,
1/900,
0.449643*9486.690430,
1/900)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
parms <- c(0.0657267,
2.7553,
0.48128 *486.690430,
1/900,
0.449643*9486.690430,
1/90000)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
parms <- c(0.0657267,
2.7553,
0.48128 *486.690430,
1/9486.690430,
0.449643*9486.690430,
(1/9486.690430)^2)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
parms <- c(0.0657267,
2.7553,
0.48128 *486.690430,
1/9486.690430,
0.449643*9486.690430,
0.64*(1/9486.690430)^2)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
parms <- c(0.0657267,
2.7553,
0.48128 *486.690430,
1/9486.690430,
0.449643*9486.690430,
0.64*(1/9486.690430)^2)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
b <- parms[1] + parms[2]*(1/(1+exp(-(doses2-parms[3])/parms[4])))
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
points(doses2,y,col=2)
parms <- c(0.0657267,
2.7553,
0.48128 *486.690430,
1/9486.690430,
0.449643*9486.690430,
0.64*(1/9486.690430)^2)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
b <- parms[1] + parms[2]*(1/(1+exp(-(doses2-parms[3])/parms[4])))
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
points(doses2,b,col=2)
parms <- c(0.0657267,
2.7553,
0.48128 *9486.690430,
9486.690430,
0.449643*9486.690430,
0.64*(1/9486.690430)^2)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
b <- parms[1] + parms[2]*(1/(1+exp(-(doses2-parms[3])/parms[4])))
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
points(doses2,b,col=2)
parms <- c(0.0657267,
2.7553,
0.48128 *9486.690430,
1.15*9486.690430,
0.449643*9486.690430,
0.64*(1/9486.690430)^2)
doses <- seq(0,1,.01)
doses2 <- seq(0,9486.690430,0.5)
b <- parms[1] + parms[2]*(1/(1+exp(-(doses2-parms[3])/parms[4])))
y2 <- cont_FUNL_f(parms ,doses2)
plot(doses2,y2)
points(doses2,b,col=2)
library(ToxicR)
A = single_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="laplace",model="FUNL",BMR=1,sstat = F)
plot(A)
library(ToxicR)
A = single_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="laplace",model="FUNL",BMR=1,sstat = F)
plot(A)
plot(doses,v1)
doses = c(0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0,
0.9486690163612366, 0.9486690163612366, 0.9486690163612366, 2.99995493888855,
2.99995493888855, 2.99995493888855, 9.486689567565918, 9.486689567565918,
9.486689567565918, 29.999547958374023, 29.999547958374023, 29.999547958374023,
94.86689758300781, 94.86689758300781, 94.86689758300781, 299.9954833984375,
299.9954833984375, 299.9954833984375, 948.6690063476562, 948.6690063476562,
948.6690063476562, 2999.954833984375, 2999.954833984375, 2999.954833984375,
9486.6904296875, 9486.6904296875, 9486.6904296875)
Y = c(6.020999908447266, 6.050000190734863, 6.113999843597412, 5.645999908447266, 6.201000213623047,
5.363999843597412, 6.271999835968018, 5.973999977111816, 6.605999946594238, 5.7769999504089355,
5.966000080108643, 5.986999988555908, 6.064000129699707, 6.508999824523926, 6.547999858856201,
6.001999855041504, 6.308000087738037, 6.583000183105469, 6.181000232696533, 6.324999809265137,
6.006999969482422, 6.547999858856201, 6.385000228881836, 6.329999923706055, 5.965000152587891,
6.230999946594238, 6.486999988555908, 6.433000087738037, 6.2729997634887695, 6.5920000076293945,
6.7870001792907715, 6.531000137329102, 6.553999900817871, 7.992000102996826, 8.246999740600586,
7.921999931335449, 8.621999740600586, 8.793999671936035, 8.609999656677246)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
c$parameters
plot(c)
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/90,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/20,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/200,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
library(ToxicR)
c = single_continuous_fit(data$doses/200,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/90,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
c$parameters
plot(c)
c = single_continuous_fit(data$doses/90,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
c = single_continuous_fit(data$doses/300,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/500,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
library(ToxicR)
c = single_continuous_fit(data$doses/500,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/600,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
c = single_continuous_fit(data$doses/500,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
library(ToxicR)
c = single_continuous_fit(data$doses/500,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
c
plot(c)
library(ToxicR)
c = single_continuous_fit(data$doses/500,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/500,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
library(ToxicR)
c = single_continuous_fit(data$doses/500,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/90,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
library(ToxicR)
c = single_continuous_fit(data$doses/90,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/40,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/200,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
plot(c)
library(ToxicR)
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
exp(-0.389)
c$parameters
exp(-5.1)
1/exp(-5.1)
doses <- seq(0,10,0.1)
library(ToxicR)
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/90,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
library(ToxicR)
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses*100,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/100,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$bmd
library(ToxicR)
c = single_continuous_fit(data$doses/100,data$y,sstat=F,
BMD_TYPE="sd",BMR=1, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$bmd
c = single_continuous_fit(data$doses/100,data$y,sstat=F,
BMD_TYPE="sd",BMR=3, distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/100,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/100,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal-ncv",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/1000,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal-ncv",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses/9000,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal-ncv",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal-ncv",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
library(ToxicR)
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal-ncv",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
c = single_continuous_fit(data$doses/900,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c$parameters
library(ToxicR)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal",
fit_type="laplace",model_type = "FUNL")
plot(c)
c = single_continuous_fit(data$doses,data$y,sstat=F,
BMD_TYPE="hybrid", distribution = "normal-ncv",
fit_type="laplace",model_type = "FUNL")
plot(c)
library(dplyr)
ii = 1
for (ii in 1:200){
print(ii)
temp <- PFOA_Liver[ii,]
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1), distribution="normal",fit_type = "laplace",sstat = F,)
plot(BB)
}
library(ToxicR)
v1 <- c(13.184152,12.8906975,12.359554,13.073001,12.861814,12.967434,12.88052,
13.249991,	12.992931,	13.022338,	13.614057,	13.287018,	13.449239,	13.950747,
13.239134,	13.82321,	15.080262,	14.85966,	14.7805395,	15.238369,	14.749196,
14.913585,	15.181719,	15.051697,	15.065641,	15.16396,	15.484345,	16.493923,
15.633442,	15.96033,	15.388061)
prior <- create_prior_list(lnormprior(0,1,-100,100),
normprior( 0, 1,-100,100),#normprior(1,2,-18,18),
lnormprior(0 ,1,0,100),
lnormprior(0,1,0,18),
normprior(0,2,-18,18));
library(readr)
PFOA_Liver <- read_table2("~/Documents/PFOA_Liver.txt",
col_names = FALSE)
doses	<- c(0,	0,	0,	0,	0.156,	0.156,	0.156,	0.3125,	0.3125,	0.3125,
0.625,	0.625,	0.625,	1.25,	1.25,	1.25,	2.5,	2.5,	2.5,	5,5,
5,	5,	10,	10,	10,	10,	20,	20,	20,	20)
#B <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", fit_type = "laplace",sstat = F)
#BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1),model_type = "hill", distribution="normal",fit_type = "mle",sstat = F,)
library(dplyr)
ii = 1
for (ii in 1:200){
print(ii)
temp <- PFOA_Liver[ii,]
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1), distribution="normal",fit_type = "laplace",sstat = F,)
plot(BB)
}
plot(doses,temp)
plot(doses,v1)
ii = 11
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1), model_type="FUNL", distribution="normal",fit_type = "laplace",sstat = F,)
plot(BB)
BB
ii
temp <- PFOA_Liver[ii,]
v1 <- as.numeric(temp[2:length(temp)])
BB <- single_continuous_fit(as.matrix(doses),as.matrix(v1), model_type="FUNL", distribution="normal",fit_type = "laplace",sstat = F,)
plot(BB)
# Ensure that ToxicR package is loaded.
# Uncomment the next 2 lines if pkgs are not being manually loaded
#library(Rcpp)
library(ToxicR)
#library(rstan)
# Input data - Continuous2.dax - Individual dose-response
M =matrix(0,nrow=26,ncol=4)
colnames(M) <- c("Dose","Resp","","")
M[,1] <- c(0,0,0,0,0,18,18,18,18,20,20,20,20,30,30,30,30,35,35,35,35,49,49,49,49,49)
M[,2] <- c(39.0,39,38.4,36.3,37.1,40.2,45.3,42.1,38.3,42.5,45.2,40.1,39.8,50.1,53.4,48.2,52.1,56.1,50.4,53.2,
55.2,55.1,59.1,56.3,52.9,53.7)
#M[,1]  = c(0, 0,   0,   0,        18,  18,  18,  18,  18,      20,   20,  20,  20,     30,  30,  30,   30,    35,    35,  35,  35,    40,  40,  40,  40,  40);
#M[,2] = c(  39,38.4,36.3,37.1,    30.2,35.3,32.1,38.3,35.9,     22.5,25.2,20.1,29.8,   10.1,13.4,11.2,12.1,    6.1,   6.4, 6.2,6.2,     3.1, 3.4, 3.3,2.9,3.7);
data <- list(N=length(M[,1]),
d = M[,1],
y = M[,2])
A = single_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="laplace",model="FUNL",BMR=1,sstat = F)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
plot(A)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
plot(A)
system.time({fit = ma_continuous_fit(matrix(data2$Doses),matrix(data2$IER3_3214),fit_type="mcmc")})
data2 <- read.delim("~/Downloads/dataFile2.txt")
system.time({fit = ma_continuous_fit(matrix(data2$Doses),matrix(data2$IER3_3214),fit_type="mcmc")})
# Ensure that ToxicR package is loaded.
# Uncomment the next 2 lines if pkgs are not being manually loaded
#library(Rcpp)
library(ToxicR)
#library(rstan)
# Input data - Continuous2.dax - Individual dose-response
M =matrix(0,nrow=26,ncol=4)
colnames(M) <- c("Dose","Resp","","")
M[,1] <- c(0,0,0,0,0,18,18,18,18,20,20,20,20,30,30,30,30,35,35,35,35,49,49,49,49,49)
M[,2] <- c(39.0,39,38.4,36.3,37.1,40.2,45.3,42.1,38.3,42.5,45.2,40.1,39.8,50.1,53.4,48.2,52.1,56.1,50.4,53.2,
55.2,55.1,59.1,56.3,52.9,53.7)
#M[,1]  = c(0, 0,   0,   0,        18,  18,  18,  18,  18,      20,   20,  20,  20,     30,  30,  30,   30,    35,    35,  35,  35,    40,  40,  40,  40,  40);
#M[,2] = c(  39,38.4,36.3,37.1,    30.2,35.3,32.1,38.3,35.9,     22.5,25.2,20.1,29.8,   10.1,13.4,11.2,12.1,    6.1,   6.4, 6.2,6.2,     3.1, 3.4, 3.3,2.9,3.7);
data <- list(N=length(M[,1]),
d = M[,1],
y = M[,2])
A = single_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="laplace",model="FUNL",BMR=1,sstat = F)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
A = ma_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="mcmc",BMR=2)
plot(A)
1.33*1.33
1.33*1.33*1.33
pi
pi*10
# Ensure that ToxicR package is loaded.
# Uncomment the next 2 lines if pkgs are not being manually loaded
#library(Rcpp)
library(ToxicR)
#library(rstan)
# Input data - Continuous2.dax - Individual dose-response
M =matrix(0,nrow=26,ncol=4)
colnames(M) <- c("Dose","Resp","","")
M[,1] <- c(0,0,0,0,0,18,18,18,18,20,20,20,20,30,30,30,30,35,35,35,35,49,49,49,49,49)
M[,2] <- c(39.0,39,38.4,36.3,37.1,40.2,45.3,42.1,38.3,42.5,45.2,40.1,39.8,50.1,53.4,48.2,52.1,56.1,50.4,53.2,
55.2,55.1,59.1,56.3,52.9,53.7)
#M[,1]  = c(0, 0,   0,   0,        18,  18,  18,  18,  18,      20,   20,  20,  20,     30,  30,  30,   30,    35,    35,  35,  35,    40,  40,  40,  40,  40);
#M[,2] = c(  39,38.4,36.3,37.1,    30.2,35.3,32.1,38.3,35.9,     22.5,25.2,20.1,29.8,   10.1,13.4,11.2,12.1,    6.1,   6.4, 6.2,6.2,     3.1, 3.4, 3.3,2.9,3.7);
data <- list(N=length(M[,1]),
d = M[,1],
y = M[,2])
A = single_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="laplace",model="hill",BMR=1,sstat = F)
A$covariance
A2 = single_continuous_fit(M[,1,drop=F],M[,2,drop=F],fit_type="laplace",model="hill",BMR=3,sstat = F)
plot(A2)
plot(A)
